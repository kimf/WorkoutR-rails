<%= render 'calendar_header' %>
<div class="calendar-wrapper">
  <%= week_calendar number_of_weeks: @num_weeks, start_date: @start, attribute: :planned_date, events: @events do |date, workouts| %>
    <small><%= date.strftime('%d %b') %></small>

    <% workouts.each do |workout| %>
      <div
        draggable="true"
        class="workout <%= workout.is_race ? 'race' : '' %> <%=workout.planned_sport.name%> <%= workout.actual_date ? 'done' : '' %>"
      >
        <header>
          <div class="sport-icon" style="background: <%= SPORT_COLORS[workout.planned_sport.name]%>">
            <%= SPORT_ICONS[workout.planned_sport.name] %>
          </div>
          <% if workout.planned_workout_type %>
            <%= workout.planned_workout_type.name %>
          <% end %>

          <% if workout.planned_minutes > 0 %>
            <%= number_with_precision(
              workout.planned_minutes,
              precision: 1,
              strip_insignificant_zeros: true
            ) %> min
          <% end %>
        </header>
        <small class="meta">
          <% if workout.planned_km > 0 %>
            <%= number_with_precision(
              workout.planned_km,
              precision: 1,
              strip_insignificant_zeros: true
            ) %> km
          <% end %>

          <% if workout.description %>
            <%= workout.description %>
          <% end %>
        </small>
      </div>
    <% end %>
  <% end %>
</div>